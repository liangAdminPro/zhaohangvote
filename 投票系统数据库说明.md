# 数据库配置及参数

## 数据库

* MongoDB

## IP

* 192.168.1.13

## Port

* 27017

## Database

* admin

## username

* zzcmb_vote

## password

* Zzcmb2019

# 数据表

## 用户

### cmb.users

``` javascript
{
  _id: String, //用户ID
  uid: String, //手机号 或者 身份证号
  mobile: String, //手机号
  uniqueUserId: String,
  expandUserId: String,
  newUserId: String,
  level: String, //用户级别 default: 无卡 LV1:普卡 LV2:金卡 LV3:金葵花 LV4:钻石卡 LV5:私人银行
  customerType: String, //客户是否持卡
  idno: String, //身份证号
  name: String, //姓名
  sex: String, //性别
  state: Number, //状态 0:正常 1:无效
  XdParams: String,
  OriginalXdParams: String,
  createdAt: Date, //创建时间
}
```

## 管理员

### cmb.admin

``` javascript
{
  _id: String, //账户ID
  userId: String, //用户ID
  mobile: String, //手机号
  username: String, //登录账号
  password: String, //密码
  salt: String, //密码混淆
  name: String, //姓名
  corpname: String, //单位名称
  initpwd: String, //初始密码
  state: Number, //状态 0:正常 1:无效
  role: String, //角色 0:管理员 1:超级管理员
  createdAt: Date, //创建时间
}
```

## 投票活动

### cmb.vote

``` javascript
{
  _id: String, //投票活动ID
  bindId: String, //关联活动ID 已废弃
  title: String, //活动标题
  tag: String, //活动标签
  tagp: String, //活动标签拼音
  address: String, //活动地点
  cover: String, //活动封面
  posterbg: String, //活动海报背景图
  start: Number, //开始时间
  end: Number, //结束时间
  shareshorturl: String, //分享短链
  desc: String, //规则介绍 可以是富文本
  rule: Object, //投票规则
  gcwrule: Object, //广场舞投票规则
  lotteryUrl: String, //抽奖地址
  lotteryDesc: String, //抽奖规则
  formset: Object, //自定义表单
  state: Number, //状态 0:正常 1:无效
  recommend: Boolean, //推荐 false:不推荐 true:推荐
  publish: Boolean, //发布状态 false:未发布 true:已发布
  self_registration: Boolean, // 是否开启自主报名
  createdAt: Date, //创建时间
  createdBy: String, //创建者ID
}
```

## 投票队伍/个人

### cmb.vote.item

``` javascript
{
  _id: String, //队伍ID
  voteId: String, //活动ID
  userId: String, //用户ID
  titleprefix: String, //队伍名/个人名 前缀
  title: String, //队伍名/个人名
  linkman: String, //负责人
  linkphone: String, //联系电话
  cover: String, //封面
  images: [String], //精彩图片
  videos: [String], //参赛视频
  slogan: String, //参赛简介
  votecount: Number, //得票数
  sharecount: Number, //分享数
  viewcount: Number, //浏览数
  state: Number, //状态 -1:待审核 0:正常 1:无效
  uids: [String],
  createdAt: Date, //创建时间
  createdBy: String, //创建者ID
}
```

## 投票记录

### cmb.vote.record

``` javascript
{
  _id: String, //记录ID
  voteId: String, //活动ID
  itemId: String, //项目ID
  userId: String, //用户ID
  voteDate: String, //投票日期
  voteYear: String, //投票日期-年
  voteMonth: String, //投票日期-月
  voteDay: String, //投票日期-日
  voteTime: String, //投票时间
  voteHour: String, //投票时间-时
  votecount: Number, //票数
  createdAt: Date, //投票时间
  ip: String, //投票ip
}
```

## 白名单

### cmb.whitelist

``` javascript
{
  _id: String, //ID
  voteId: String, //活动ID
  wid: String, //手机号 或者 身份证号
  level: String, //用户级别 W5:5W W10:10W
  phone: String, //手机号
  idno: String, //身份证号
  name: String, //姓名
  birth: String, //生日
  state: Number, //状态 0:正常 1:无效
  createdAt: Date, //创建时间
  createdBy: String, //创建者ID
}
```

## 投票活动数据统计

### cmb.statistics

``` javascript
{
  _id: String, //ID
  voteId: String, //活动ID
  createdAt: Date, //创建时间
  updatedAt: Date,
  Date: String,
  year: String,
  month: String,
  day: String,
  newUserCount: Number, //新用户
  viewCount: Number, //访问数
  voteCount: Number, //投票数
  voteRecordCount: Number, //投票记录数
  voteUserCount: Number, //投票用户
  activeCount: Number, //活跃数
  activeUserCount: Number, //活跃用户数
}
```

## 投票用户数据统计

### cmb.statistics.activeusers

``` javascript
{
  _id: String,
  voteId: String, //活动ID
  userId: String,
  Date: String,
  year: String,
  month: String,
  day: String,
  createtime: String,
}
```
